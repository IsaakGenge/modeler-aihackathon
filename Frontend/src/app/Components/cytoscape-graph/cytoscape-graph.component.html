<div class="graph-container">
  <div class="layout-controls" *ngIf="showLayoutControls">
    <div class="layout-buttons">
      <button *ngFor="let layout of availableLayouts"
              [class.active]="layoutConfig.name === layout.type"
              (click)="changeLayoutType(layout.type)"
              title="{{layout.label}}"
              class="layout-button">
        <i class="bi" [ngClass]="getLayoutIcon(layout.type)"></i>
      </button>

      <!-- Add Save Positions button -->
      <button (click)="saveNodePositions()"
              title="Save Node Positions"
              class="layout-button"
              [class.has-changes]="positionsChanged"
              [disabled]="isSaving || !positionsChanged">
        <i class="bi" [ngClass]="isSaving ? 'bi-hourglass-split' : 'bi-save'"></i>
      </button>

      <!-- Add Apply Saved Layout button -->
      <button (click)="applySavedLayout()"
              title="Apply Saved Layout"
              class="layout-button"
              [disabled]="isApplyingSaved || !graphId">
        <i class="bi" [ngClass]="isApplyingSaved ? 'bi-hourglass-split' : 'bi-arrow-counterclockwise'"></i>
      </button>

      <!-- Add separator -->
      <div class="layout-button-divider"></div>

      <!-- Add Zoom In button -->
      <button (click)="zoomIn()"
              title="Zoom In"
              class="layout-button">
        <i class="bi bi-zoom-in"></i>
      </button>

      <!-- Add Zoom Out button -->
      <button (click)="zoomOut()"
              title="Zoom Out"
              class="layout-button">
        <i class="bi bi-zoom-out"></i>
      </button>

      <!-- Add Fit Graph button -->
      <button (click)="fitGraph()"
              title="Fit to Screen"
              class="layout-button">
        <i class="bi bi-fullscreen"></i>
      </button>
    </div>
  </div>
  <div #cyContainer class="cytoscape-container"></div>

  <!-- Details panel component -->
  <app-details-panel [selectedElement]="selectedElement"
                     [graphId]="graphId"
                     [isDarkMode$]="isDarkMode$"
                     (closePanel)="closeDetailsPanel()">
  </app-details-panel>
</div>
