<!-- Frontend/src/app/Components/view-fancy/view-fancy.component.html -->
<div class="view-fancy-container" [class.dark-mode]="(isDarkMode$ | async)">
    <!-- Main content area -->
  <div class="main-content-area" *ngIf="hasSelectedGraph">
    <!-- Graph Visualization - Expanded when tools panel is collapsed -->
    <div class="graph-container" [class.expanded]="toolsPanelCollapsed">
      <div class="graph-header">
        <div class="graph-picker-row">
          <app-graph-picker (graphSelected)="onGraphSelected($event)"></app-graph-picker>
        </div>
      </div>

      <div *ngIf="loading" class="loading-indicator">
        Loading graph data...
      </div>

      <div *ngIf="warning" class="alert alert-warning">
        {{ warning }}
        <button class="btn btn-outline-secondary btn-sm" (click)="loadGraphData()">
          Refresh
        </button>
      </div>

      <div *ngIf="error" class="alert alert-danger">
        {{ error }}
        <button class="btn btn-outline-secondary btn-sm" (click)="loadGraphData()">
          Refresh
        </button>
      </div>

      <!-- Replace the old cytoscape container with our new component -->
      <app-cytoscape-graph *ngIf="!loading"
                           [nodes]="graphNodes"
                           [edges]="graphEdges"
                           [isDarkMode$]="isDarkMode$"
                           [showLayoutControls]="true"
                           (nodeClicked)="onNodeClicked($event)"
                           (edgeClicked)="onEdgeClicked($event)"
                           (layoutChanged)="onLayoutChanged($event)"
                           class="cytoscape-graph-component">
      </app-cytoscape-graph>

    </div>

    <!-- Tools Panel - Collapsible -->
    <div class="tools-panel-container" [class.collapsed]="toolsPanelCollapsed">
      <!-- Tools Panel Toggle Button -->
      <button class="tools-panel-toggle" (click)="toggleToolsPanel()">
        <i class="bi" [ngClass]="toolsPanelCollapsed ? 'bi-chevron-left' : 'bi-chevron-right'"></i>
      </button>

      <div class="tools-panel">
        <ul ngbNav #nav="ngbNav" [(activeId)]="activeTab" class="nav-tabs">
          <li [ngbNavItem]="1">
            <a ngbNavLink>Nodes</a>
            <ng-template ngbNavContent>
              <app-create-node></app-create-node>
            </ng-template>
          </li>
          <li [ngbNavItem]="2">
            <a ngbNavLink>Edges</a>
            <ng-template ngbNavContent>
              <app-create-edge></app-create-edge>
            </ng-template>
          </li>
        </ul>

        <div [ngbNavOutlet]="nav" class="tab-content"></div>
      </div>
    </div>
  </div>
</div>
